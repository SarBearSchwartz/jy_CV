levels = 1:7,
labels = c("Northern Utah",
"Central and Southern Utah",
"Idaho",
"West Coast",
"Midwest",
"East Coast",
"Outside Continential US"))) %>%
dplyr::mutate(time = "Post") %>%
dplyr::rename(religionother_post = religionother)
PSERSCfinal
PSERSCfinal %>%
dplyr::filter(uniqueid == "albr1001") %>%
dplyr::select(uniqueid, region, everything())
data_long_all <- dplyr::full_join(PSERSCinitial, PSERSCfinal, by = c("uniqueid", "time")) %>%
dplyr::mutate(time = factor(time,
levels = c("Pre", "Post"))) %>%
dplyr::select(uniqueid, time, everything()) %>%
dplyr::arrange(uniqueid, time) %>%
dplyr::mutate(record_id_pre = as.numeric(record_id_pre)) %>%
dplyr::mutate(record_id_post = as.numeric(record_id_post)) %>%
dplyr::filter(!is.na(uniqueid)) %>%
dplyr::filter(uniqueid != "covd69") %>%
dplyr::filter(!(uniqueid == "brha17" & time ==  "Pre" & record_id_pre == 320)) %>%
dplyr::filter(!(uniqueid == "alhi28" & time == "Post" & record_id_post ==  43)) %>%
dplyr::filter(!(uniqueid == "chni09-13" & time == "Post" & record_id_post %in% c(78, 79, 80))) %>%
dplyr::filter(!(uniqueid == "frto0905" & time == "Pre" & record_id_pre %in% c(137, 138))) %>%
dplyr::filter(!(uniqueid == "jero04-04" & time == "Post" & record_id_post == 85)) %>%
dplyr::filter(!(uniqueid == "kadu78" & time == "Post" & record_id_post == 14)) %>%
dplyr::filter(!(uniqueid == "kawo0720" & time == "Pre" & record_id_pre == 178)) %>%
dplyr::filter(!(uniqueid == "mawi30" & time == "Post" & record_id_post == 66)) %>%
dplyr::filter(!(uniqueid == "mifu0907" & time == "Post" & record_id_post == 19)) %>%
dplyr::filter(!(uniqueid == "resc01-31" & time == "Post" & record_id_post == 6)) %>%
dplyr::filter(!(uniqueid == "tezo03" & time == "Post" & record_id_post == 12)) %>%
dplyr::filter(!(uniqueid == "wehu25" & time == "Post" & record_id_post == 20)) %>%
dplyr::filter(!(uniqueid == "jewi420" & time == "Pre" & record_id_pre == 344)) %>%
dplyr::filter(!(uniqueid == "kish1205" & time == "Post" & record_id_post == 3)) %>%
dplyr::filter(!(uniqueid == "skpr16" & time == "Post" & record_id_post == 9)) %>%
# dplyr::select(-redcap_survey_identifier,
#               -consent) %>%
dplyr::select(uniqueid, record_id_pre, record_id_post, time, group, condition, everything())
data_long_all
names(data_long_all)
table(data_long_all$time)
data_long_all %>%
dplyr::filter(time == "Pre") %>%
furniture::tableF(Intervention)
data_long_all %>%
dplyr::select(uniqueid, record_id_pre, record_id_post, time, group, condition) %>%
dplyr::group_by(uniqueid) %>%
dplyr::
load("data_preped.RData")
data_long <- data_long %>%
dplyr::mutate(condition = facotr(condition)) %>%
dplyr::group_by(uniqueid) %>%
dplyr::mutate(Region3 = first(Region3)) %>%
dplyr::mutate(coundition = first(condition)) %>%
dplyr::ungroup()
data_long <- data_long %>%
dplyr::mutate(condition = factor(condition)) %>%
dplyr::group_by(uniqueid) %>%
dplyr::mutate(Region3 = first(Region3)) %>%
dplyr::mutate(coundition = first(condition)) %>%
dplyr::ungroup()
data_long_all <- data_long_all %>%
dplyr::group_by(uniqueid) %>%
dplyr::mutate(Region3 = first(Region3),
condition = first(condition),
group = first(group),
Group = first(Group)) %>%
dplyr::ungroup() %>%
dplyr::select(uniqueid, Group, condition, time, everything())
load("data_preped.RData")
data_long <- data_long %>%
dplyr::mutate(condition = factor(condition)) %>%
dplyr::group_by(uniqueid) %>%
dplyr::mutate(Region3 = first(Region3)) %>%
dplyr::mutate(coundition = first(condition)) %>%
dplyr::ungroup()
data_long_all <- data_long_all %>%
dplyr::mutate(condition = factor(condition)) %>%
dplyr::group_by(uniqueid) %>%
dplyr::mutate(Region3 = first(Region3),
condition = first(condition),
group = first(group),
Group = first(Group)) %>%
dplyr::ungroup() %>%
dplyr::select(uniqueid, Group, condition, time, everything())
data_long_all %>%
dplyr::select(uniqueid, time,
Group, group, condition,
Region3,
Efficacy, SCEfficacy,
SexKnowledge, CDKnowledge) %>%
dplyr::arrange(uniqueid, time)
load("data_preped.RData")
data_long <- data_long %>%
dplyr::mutate(condition = factor(condition)) %>%
dplyr::group_by(uniqueid) %>%
dplyr::mutate(Region3 = first(Region3)) %>%
dplyr::mutate(coundition = first(condition)) %>%
dplyr::ungroup()
data_long_all <- data_long_all %>%
dplyr::mutate(condition = factor(condition)) %>%
dplyr::group_by(uniqueid) %>%
dplyr::mutate(Region3 = first(Region3),
# condition = first(condition),
group = first(group),
Group = first(Group)) %>%
dplyr::ungroup() %>%
dplyr::select(uniqueid, Group, condition, time, everything())
data_long_all %>%
dplyr::select(uniqueid, time,
Group, group, condition,
Region3,
Efficacy, SCEfficacy,
SexKnowledge, CDKnowledge) %>%
dplyr::arrange(uniqueid, time)
load("data_preped.RData")
data_long_all <- data_long_all %>%
dplyr::mutate(condition = factor(condition)) %>%
dplyr::group_by(uniqueid) %>%
dplyr::mutate(Region3 = first(Region3),
condition = first(condition),
group = first(group),
Group = first(Group)) %>%
dplyr::ungroup() %>%
dplyr::select(uniqueid, Group, condition, time, everything())
data_long_all %>%
dplyr::select(uniqueid, time,
Group, group, condition,
Region3,
Efficacy, SCEfficacy,
SexKnowledge, CDKnowledge) %>%
dplyr::arrange(uniqueid, time)
load("data_preped.RData")
data_long_all <- data_long_all %>%
dplyr::mutate(condition = factor(condition)) %>%
dplyr::group_by(uniqueid) %>%
dplyr::mutate(Region3 = first(Region3),
condition = max(condition),
group = first(group),
Group = first(Group)) %>%
dplyr::ungroup() %>%
dplyr::select(uniqueid, Group, condition, time, everything())
?first
load("data_preped.RData")
data_long <- data_long %>%
dplyr::group_by(uniqueid) %>%
dplyr::mutate(Region3 = first(Region3)) %>%
dplyr::mutate(coundition = first(condition)) %>%
dplyr::ungroup()
data_long_all <- data_long_all %>%
dplyr::mutate(condition = factor(condition)) %>%
dplyr::group_by(uniqueid) %>%
dplyr::mutate(Region3 = first(Region3),
condition = last(condition),
group = first(group),
Group = first(Group)) %>%
dplyr::ungroup() %>%
dplyr::select(uniqueid, Group, condition, time, everything())
data_long_all %>%
dplyr::select(uniqueid, time,
Group, group, condition,
Region3,
Efficacy, SCEfficacy,
SexKnowledge, CDKnowledge) %>%
dplyr::arrange(uniqueid, time)
data_long_all %>%
dplyr::filter(time == "Pre") %>%
dplyr::group_by(condition) %>%
furniture::table1(Efficacy,
Religiosity,
SCEfficacy,
FOOReligiosity,
CDKnowledge,
SexKnowledge,
Mothereducation,
Region3,
Religion3,
Trauma,
ChildAgeAv,
Parentage,
na.rm = FALSE,
total = TRUE,
test = TRUE,
type = "full")
fit_anova_eff_reg <- data_long_all %>%
dplyr::filter(time == "Pre") %>%
afex::aov_4(SCEfficacy ~ Region3 + (1|uniqueid ),
data=.)
fit_anova_eff_reg %>%
summary()
fit_anova_eff_reg <- data_long_all %>%
dplyr::filter(time == "Pre") %>%
afex::aov_4(SCEfficacy ~ Region3 + (1|uniqueid ),
data=.)
fit_anova_eff_reg %>%
summary()
data_long %>%
ggplot(aes(x = time,
y = SCEfficacy)) +
geom_point(alpha = .3) +
geom_line(aes(group = uniqueid),
alpha = .3) +
theme_bw() +
facet_grid(~ condition) +
geom_smooth(aes(group = condition),
method = "lm") +
labs(x = NULL,
y = "Self Efficacy")
data_long %>%
car::leveneTest(SCEfficacy ~ time*condition,
data = .,
center = mean)
AOVpost <- data_long %>%
afex::aov_4(SCEfficacy ~ condition + (time|uniqueid),
data=.,
anova_table = list(correction = "none",
es = c("ges", "pes")))
AOVpost
fig1a <- AOVpost %>%
emmeans::emmeans(~ condition*time) %>%
data.frame() %>%
ggplot(aes(x = time,
y = emmean,
group = condition,
shape = condition,
linetype = condition,
color = condition)) +
geom_errorbar(aes(ymin = emmean - SE,
ymax = emmean + SE),
linetype = "solid",
show.legend = FALSE,
position = position_dodge(width = .3),
width = .3) +
geom_point(size = 2.5,
position = position_dodge(width = .3)) +
geom_line(size = 1,
position = position_dodge(width = .3)) +
theme_bw() +
labs(x = "Time",
shape = "Condition: ",
y = "Parental Self-Efficacy Regarding\n Sexual Communicationy",
color = "Condition: ",
linetype = "Condition: ") +
theme(legend.position = "bottom",
legend.key.width = unit(2, "cm")) +
scale_linetype_manual(values = c("solid", "longdash", "dotted")) +
scale_color_manual(values = c("#1b9e77", "#7570b3", "#d95f02")) +
scale_shape_manual(values = c(15, 19, 17))
fig1a
fit_aov_se_2 <- data_long %>%
dplyr::filter(condition != "Control") %>%
dplyr::mutate(Dose = case_when(time_spent == 0 ~ "Never",
time_spent == 1 ~ "Once",
time_spent > 1 ~ "More than Once") %>%
forcats::fct_relevel("Never", "Once", "More than Once")) %>%
afex::aov_4(SCEfficacy ~ condition*Dose + (time|uniqueid),
data=.,
anova_table = list(es = c("ges", "pes")))
fit_aov_se_2
fit <- lmerTest::lmer(SCEfficacy ~ condition*time + (1|uniqueid),
data =  data_long_all,
REML = FALSE)
anova(fit)
interactions::interact_plot(model = fit,
pred = time,
modx = condition)
interactions::cat_plot(model = fit,
pred = time,
modx = condition)
interactions::cat_plot(model = fit,
pred = time,
modx = condition,
geom = "line")
fit <- lmerTest::lmer(SCEfficacy ~ condition*time + CDKnowledge + SCEfficacy + (1|uniqueid),
data =  data_long_all,
REML = FALSE)
fit <- lmerTest::lmer(SCEfficacy ~ condition*time + CDKnowledge + SexKnowledge + (1|uniqueid),
data =  data_long_all,
REML = FALSE)
anova(fit)
interactions::cat_plot(model = fit,
pred = time,
modx = condition,
geom = "line")
# set global chunk options...
#  this changes the defaults so you don't have to repeat yourself
knitr::opts_chunk$set(comment     = "",
echo        = TRUE,
warning     = FALSE,
message     = FALSE,
fig.pos     = 'hb',
fig.align   = "center",
fig.width   = 4,
fig.height  = 3)
library(magrittr)
library(tidyverse)    # Loads the CORE packages
library(corrplot)     # graphical display of a correltaion matrix
library(gpairs)       # generalized pairs plots
library(GGally)       # extensions to ggplot2
library(furniture)    # Nice table1() descriptives
library(car)          # Companion to Applied Regression
library(stargazer)    # Display nice tables: summary & regression
library(texreg)       # Convert Regression Output to LaTeX or HTML Tables
library(texreghelpr)  #
library(psych)        # Nice little bits (headTail)
library(pander)       # create HTML tables
library(xtable)       # export tables to latex or html
library(lme4)         # Linear, generalized linear, & nonlinear mixed models
library(lmerTest)     # Tests on lmer objects
library(optimx)       # Allows different optimizers in lmer (lme4)
library(HLMdiag)      # Diagnostic Tools for for nlme & lmer4
library(sjstats)
library(sjPlot)       # Plotting lme4 results
library(effects)
library(performance)
library(interactions)
panderOptions('digits', 2)
panderOptions('round', 2)
panderOptions('keep.trailing.zeros', TRUE)
data_religion <- haven::read_spss("https://raw.githubusercontent.com/CEHS-research/data/master/Hoffmann_datasets/religion.sav") %>%
haven::as_factor() %>%
dplyr::mutate(attendF = as.factor(attend)) %>%
dplyr::mutate(incomeN = as.numeric(income))
tibble::glimpse(data_religion)
data_religion %>%
furniture::tableX(attend, attendF)
data_religion %>%
furniture::tableX(income, incomeN)
data_religion %>%
dplyr::group_by(relschol) %>%
furniture::table1("Race" = race,
"Sex" = sex,
"Age, years" = age,
"Marital Status" = married,
"Education" = educ,
digits = 3,
total   = TRUE,
test    = TRUE,
na.rm   = FALSE,
output  = "markdown",
caption = "Summary Statistics: Participant's Demographics by Attendance at a Religious Affiliated High School")
data_religion %>%
dplyr::group_by(relschol) %>%
furniture::table1("Continuous" = attend,
"Categorical" = attendF,
digits = 3,
total   = TRUE,
test    = TRUE,
na.rm   = FALSE,
output  = "markdown",
caption = "Summary Statistics: Participants' Monthly Religious Attendance by Attendance at a Religious Affiliated High School's")
data_religion %>%
ggplot(aes(attendF)) +
geom_bar(color = "black",
alpha = .5)
data_religion %>%
dplyr::group_by(relschol) %>%
furniture::table1("Continuous" = incomeN,
"Categorical" = income,
digits = 3,
total   = TRUE,
test    = TRUE,
na.rm   = FALSE,
output  = "markdown",
caption = "Summary Statistics: Participants' Annual Household Income by Attendance at a Religious Affiliated High School's ")
data_religion %>%
ggplot(aes(income)) +
geom_bar(color = "black",
alpha = .5) +
coord_flip()
data_religion %>%
dplyr::select(relschol) %>%
table() %>%
addmargins()
data_religion %>%
furniture::tableF(relschol)
prob <- 80 / 626
prob
odds <- 80 / 546
odds
prob / (1- prob)
data_religion %>%
dplyr::select(relschol, race) %>%
table() %>%
addmargins()
data_religion %>%
furniture::tableX(relschol, race)
prob_white <- 54 / 524
prob_white
prob_nonwhite <- 26/102
prob_nonwhite
odds_white <- 54 / 470
odds_white
odds_nonwhite <- 26/76
odds_nonwhite
odds_ratio_race <- odds_white / odds_nonwhite
odds_ratio_race
(prob_white/(1 - prob_white)) / (prob_nonwhite/(1 - prob_nonwhite))
(54/470)/(26/76)
fit_glm_1 <- glm(relschol ~ race,
data = data_religion,
family = binomial(link = "logit"))
summary(fit_glm_1)
texreg::knitreg(list(fit_glm_1,
texreghelpr::extract_glm_exp(fit_glm_1)),
custom.model.names = c("b (SE)", "OR [95 CI]"),
custom.coef.map = list("(Intercept)" = "(Intercept)",
"racewhite" = "White vs. Non-White"),
caption = "Logistic Regression, Unadjusted Model",
caption.above = TRUE,
float.pos = "hb",
single.row = TRUE,
test.ci = 1)
setwd("~/GitHub/jy_CV")
ezpickr::pick("data/service.xlsx") %>%
tidyr::fill(-where
) %>%
dplyr::arrange(desc(order)) %>%
vitae::detailed_entries(what, when, with, where)
library(tidyverse)
ezpickr::pick("data/students.xlsx") %>%
tidyr::fill(-why) %>%
dplyr::filter(level == "phd",
time == "current",
me == "member") %>%
dplyr::arrange(desc(when)) %>%
vitae::detailed_entries(what, when, with, where, why)
ezpickr::pick("data/students.xlsx") %>%
tidyr::fill(-why) %>%
dplyr::filter(level == "phd",
time == "past",
me == "mentor") %>%
vitae::detailed_entries(what, when, with, where, why)
ezpickr::pick("data/students.xlsx") %>%
tidyr::fill(-why) %>%
dplyr::filter(level == "phd",
time == "past",
me == "member") %>%
dplyr::arrange(desc(when)) %>%
vitae::detailed_entries(what, when, with, where, why)
ezpickr::pick("data/students.xlsx") %>%
tidyr::fill(-why) %>%
dplyr::filter(level == "ms",
time == "current",
me == "member") %>%
dplyr::arrange(desc(when)) %>%
vitae::detailed_entries(what, when, with, where, why)
ezpickr::pick("data/students.xlsx") %>%
tidyr::fill(-why) %>%
dplyr::filter(level == "ms",
time == "current",
me == "member") %>%
dplyr::arrange(desc(when)) %>%
vitae::detailed_entries(what, when, with, where, why)
ezpickr::pick("data/students.xlsx") %>%
tidyr::fill(-why) %>%
dplyr::filter(level == "ms",
time == "past",
me == "member") %>%
dplyr::arrange(desc(when)) %>%
vitae::detailed_entries(what, when, with, where, why)
ezpickr::pick("data/students.xlsx") %>%
tidyr::fill(-why) %>%
dplyr::filter(level == "phd",
time == "current",
me == "member") %>%
dplyr::arrange(desc(order)) %>%
vitae::detailed_entries(what, when, with, where, why)
ezpickr::pick("data/students.xlsx") %>%
tidyr::fill(-why) %>%
dplyr::filter(level == "ms",
time == "current",
me == "member") %>%
dplyr::arrange(desc(order)) %>%
vitae::detailed_entries(what, when, with, where, why)
ezpickr::pick("data/students.xlsx") %>%
tidyr::fill(-why) %>%
dplyr::filter(level == "phd",
time == "past",
me == "member") %>%
dplyr::arrange(desc(order)) %>%
vitae::detailed_entries(what, when, with, where, why)
ezpickr::pick("data/students.xlsx") %>%
tidyr::fill(-why) %>%
dplyr::filter(level == "ms",
time == "past",
me == "member") %>%
dplyr::arrange(desc(order)) %>%
vitae::detailed_entries(what, when, with, where, why)
ezpickr::pick("data/students.xlsx") %>%
tidyr::fill(-why) %>%
dplyr::filter(level == "phd",
time == "past",
me == "member") %>%
dplyr::arrange(desc(order)) %>%
vitae::detailed_entries(what, when, with, where, why)
ezpickr::pick("data/students.xlsx") %>%
tidyr::fill(-why) %>%
dplyr::filter(level == "phd",
time == "past",
me == "mentor") %>%
vitae::detailed_entries(what, when, with, where, why)
ezpickr::pick("data/students.xlsx") %>%
tidyr::fill(-why) %>%
dplyr::filter(level == "ms",
time == "current",
me == "member") %>%
dplyr::arrange(desc(order)) %>%
vitae::detailed_entries(what, when, with, where, why)
